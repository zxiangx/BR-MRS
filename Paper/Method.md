## 方法 (The Proposed Method)

在本节中, 我们介绍BR-MRS,这是一种专为个性化排序任务设计的多模态推荐框架，旨在通过显式建模并优化模态间的**独特信息**与**协同信息**, 以实现推荐任务性能的提升. 具体而言, 本方法包括一个跨模态难负采样模块, 通过迫使每个模态判别另一模态混淆的负样本, 在推荐任务中贡献模态的独特信息。以及一个协同BPR损失模块, 通过偏好边际约束促使多模态融合表征的排序性能优于单模态, 从而在推荐任务中激励模态协同。 图2和算法1描述了我们提出的BR-MRS框架的具体流程。 



## 4.1 跨模态硬负样本采样

由于直接使用正交约束难以对齐推荐任务中对用户偏好进行个性化排序的目标, 因此, 我们迫切需要一种在服务于个性化排序目标的前提下, 同时又能主动挖掘并利用每个模态特有的判别信息的方法.  具体而言, 我们希望一个模态对某些样本混淆时,另一个模态能够贡献其独特的信息起到判别作用。在这种目标的驱动下,我们重新审视推荐系统中被广泛使用的贝叶斯个性化排序损失, 其中的核心组件负采样策略--已被证明能够有效增强模型的判别能力 ,然而, 以往的负采样方法通常局限在提升整体的负样本辨别质量, 忽略了其挖掘模态独特信息的潜力.  

为此，我们提出跨模态硬负样本采样（CHNS)模块, 采用负采样策略激活模态特有的判别能力, 以提升模型的个性化排序表现。 具体而言, 对于每个正样本对 $(u, i^+) \in \mathcal{O}$, 我们首先随机采样一个候选负样本池 $\mathcal{N}(u) \subseteq \mathcal{I} \setminus \mathcal{O}_u$中,随后, 我们在每个模态下分别识别其最容易产生混淆的负样本: 

$$
\begin{aligned}
j_v(u, i^+) &= \arg\max_{j \in \mathcal{N}(u)} s_v(u, j), \
j_t(u, i^+) &= \arg\max_{j \in \mathcal{N}(u)} s_t(u, j).
\end{aligned}
$$

其中$j_v$ 表示在视觉模态下最难与正样本区分的负样本，而 $j_t$ 表示在文本模态下最具混淆性的负样本。 
接下来, 我们利用一个模态所对应的困难负样本来训练另一模态的排序分支, 从而显式要求该模态贡献其独特信息用于提供判别证据. 相对应的损失函数定义为 
$$
\mathcal{L}*{\mathrm{chns}} = -\sum*{(u,i^+) \in \mathcal{O}} \left[ \log \sigma\left(s_t(u,i^+) - s_t(u, j_v(u,i^+))\right) + \log \sigma\left(s_v(u,i^+) - s_v(u, j_t(u,i^+))\right) \right].
$$
其中，第一项(\sigma\left(s_t(u,i^+) - s_t(u, j_v(u,i^+))\right))表示文本模态需要区分视觉模态所难以区分的负样本；第二项(\sigma\left(s_v(u,i^+) - s_v(u, j_t(u,i^+))\right))则表示视觉模态需要区分文本空间的混淆案例。通过这种跨模态监督的设计，CHNS明确激励各模态发挥自身独特的判别优势，以更好地服务于个性化排序目标。


---

## 4.2 协同感知 BPR 损失

第一段: 问题定位加设计目标, 把为什么要做SynergyBPR讲清楚
句1: 承上启下
句2: 指出传统约束在推荐任务中难以学习到协同信息, 甚至出现融合退化的原因
句3: 提出设计目标和约束: 直观上,融合后的多模态表征应该承载了多模态联合推断的能力,直接优化融合表征不可行,因为协同信息是隐变量, 理论上,协同信息出现的时候应该呈现出排序能力相对于任一单模态的严格优势

第二段: 


在学习到模态独特信息之后, 我们进一步关注如何在推荐任务中建模模态协同信息。 协同信息指只有联合两个模态才能获取的判别线索, 它并不能从任一单模态中单独推断出来, 可能是用户偏好的关键决定因素。 


直观上, 融合后的多模态表征如果捕获了协同信息, 它在排序能力上应该呈现出对于任一单模态的严格优势。反之, 如果融合分支反而弱于单模态分支, 则融合表示可能退化为冗余或被噪声稀释的表征,而无法有效利用跨模态协同线索。  

直接最大化融合表征中的协同信息, 似乎是一种直接的做法, 然而, 协同信息是不可观测的隐变量, 给优化带来了困难。 之前的方法通常会直接在融合表征上施加BPR损失, 期望从端到端的优化中隐式增强模型利用协同信息的能力, 但仍然无法保障 退化问题, 即融合表征的排序性能反而比任一单模态都要更差,而InfoNCE等组件仍然不足以学习协同信息. 因此我们重新审视推荐系统中的BPR组件, 

 

具体而言, 我们对融合表示施加严格的偏好边际约束,使得融合分支相对于单模态拥有更明显的判别优势。 我们设计了称为Synergy-aware BPR的损失函数: 
Lsyn​=−(u,i+,i−)∑​logσ(Δf​−max(Δt​,Δv​)−θ), 
其中xxx . 

通过这种显式的协同约束设计，融合表示能够主动学习跨模态的协同信息，约束模态融合后在个性化排序任务中地超越任一单模态的表现。

---

## 4.3 训练策略

我们将融合BPR损失、跨模态硬负样本采样损失以及协同感知损失整合，形成BR-MRS的统一训练目标：

$$
\mathcal{L} =  \lambda_h \mathcal{L}*{\mathrm{chns}} + \lambda_s \mathcal{L}_{\mathrm{syn}} + \lambda |\Theta|_2^2,
$$

其中，$\mathcal{L}_{\mathrm{BPR}}$为标准融合排序损失，$\lambda_h$和$\lambda_s$分别调控CHNS和协同感知损失的贡献，$\lambda$为正则化系数，$\Theta$表示模型所有的可训练参数。
